import requests
from bs4 import BeautifulSoup

# Safe payloads (for learning purpose only)
SQL_PAYLOAD = "' OR '1'='1"
XSS_PAYLOAD = "<script>alert('XSS')</script>"

def scan_sql_injection(url):
    print("\n[+] Scanning for SQL Injection...")
    try:
        test_url = url + "?id=" + SQL_PAYLOAD
        response = requests.get(test_url, timeout=10)

        if "sql" in response.text.lower() or "mysql" in response.text.lower():
            print("[‚ö†Ô∏è] Possible SQL Injection vulnerability detected!")
        else:
            print("[‚úÖ] No SQL Injection vulnerability detected.")
    except Exception as e:
        print("[‚ùå] SQL Injection scan failed:", e)

def scan_xss(url):
    print("\n[+] Scanning for XSS...")
    try:
        response = requests.get(url, timeout=10)
        soup = BeautifulSoup(response.text, "html.parser")

        forms = soup.find_all("form")

        if forms:
            print("[‚ÑπÔ∏è] Forms found. Checking for reflected XSS...")
            if XSS_PAYLOAD in response.text:
                print("[‚ö†Ô∏è] Possible XSS vulnerability detected!")
            else:
                print("[‚úÖ] No XSS vulnerability detected.")
        else:
            print("[‚ÑπÔ∏è] No forms found on the page.")
    except Exception as e:
        print("[‚ùå] XSS scan failed:", e)

def main():
    print("===================================")
    print("   üîê Web Vulnerability Scanner")
    print("===================================")

    url = input("Enter target URL (example: http://testphp.vulnweb.com): ").strip()

    if not url.startswith("http"):
        print("‚ùå Invalid URL. Please include http:// or https://")
        return

    scan_sql_injection(url)
    scan_xss(url)

    print("\n‚úî Scan completed successfully.")

if __name__ == "__main__":
    main()
